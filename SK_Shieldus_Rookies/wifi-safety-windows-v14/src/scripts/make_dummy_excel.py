# src/make_dummy_excel.py
import os
import pandas as pd
from datetime import datetime

# 공공엑셀과 동일한 컬럼 헤더
COLS = [
    "설치장소명","설치장소상세","설치시도명","설치시군구명","설치시설구분","서비스제공사명",
    "와이파이SSID","설치연월","소재지도로명주소","소재지지번주소","관리기관명","관리기관전화번호",
    "WGS84위도","WGS84경도","데이터기준일자"
]

def rows():
    today = datetime.utcnow().strftime("%Y-%m-%d")
    return [
        # 1) 일반 게스트(204)
        ["시청 도서관","1층 로비","서울특별시","중구","공공도서관","KT",
         "SeoulLibrary_Free","2022-05","서울 중구 세종대로 110","","서울시청","02-120",
         37.5665,126.9780,today],
        # 2) 공공 포털 (게스트)
        ["메트로 와이파이","역사 내","서울특별시","종로구","지하철역","SKT",
         "Metro_Free_WiFi","2021-11","서울 종로구 종로1","", "서울교통공사","02-6110-1234",
         37.5700,126.9820,today],
        # 3) 키오스크/주문 (POS/QR)
        ["스마트카페 강남점","테이블오더 구역","서울특별시","강남구","카페(테이블오더)","LGU+",
         "SmartCafe_ORDER","2020-08","서울 강남구 테헤란로 123","", "스마트카페","02-555-0001",
         37.4980,127.0270,today],
        # 4) 스태프 전용(관리/Admin)
        ["굿버거 신촌점","주방/관리실","서울특별시","서대문구","음식점(관리)","KT",
         "GoodBurger_STAFF","2019-03","서울 서대문구 연세로 11","", "굿버거코리아","02-333-0002",
         37.5599,126.9419,today],
        # 5) 쇼핑몰 포털
        ["메가몰","푸드코트","부산광역시","해운대구","쇼핑몰","SKT",
         "MegaMall_Free","2023-06","부산 해운대구 센텀남대로 35","", "메가몰","051-777-0001",
         35.1702,129.1306,today],
        # 6) 레스토랑 테이블오더
        ["파스타하우스","홀 테이블오더","대구광역시","중구","음식점(테이블오더)","KT",
         "PastaHouse_TableOrder","2022-09","대구 중구 중앙대로 100","", "파스타하우스","053-222-0001",
         35.8714,128.6014,today],
        # 7) 관리자 패널 노출 위험(배너 Admin 등 시뮬)
        ["IoT 라운지","장비실","서울특별시","용산구","전시장(관리)","LGU+",
         "IOT_Admin","2018-12","서울 용산구 한강대로 100","", "IOT센터","02-700-0001",
         37.5299,126.9647,today],
        # 8) 버스 공공와이파이 (SMS 포털)
        ["시내버스 1234번","차내","부산광역시","부산진구","버스","KT",
         "Bus_Free_WiFi","2024-02","부산 부산진구 중앙대로 500","", "부산버스조합","051-600-0001",
         35.1576,129.0595,today],
        # 9) 카페 POS 로그인
        ["카페모모","카운터","서울특별시","마포구","카페(키오스크)","SKT",
         "CafeMomo_POS","2019-10","서울 마포구 와우산로 45","", "카페모모","02-444-0003",
         37.5520,126.9220,today],
        # 10) 일반 게스트(안전)
        ["동네도서관","열람실","대구광역시","수성구","공공도서관","LGU+",
         "LocalLib_Free","2023-04","대구 수성구 들안로 12","", "수성구청","053-666-0001",
         35.8587,128.6306,today],
    ]

if __name__ == "__main__":
    base_dir = os.path.dirname(os.path.abspath(__file__))
    assets_dir = os.path.normpath(os.path.join(base_dir, "..", "assets"))
    os.makedirs(assets_dir, exist_ok=True)
    out_path = os.path.join(assets_dir, "dummy_wifi.xlsx")
    df = pd.DataFrame(rows(), columns=COLS)
    # 엑셀 저장 (openpyxl 필요)
    df.to_excel(out_path, index=False)
    print("✅ 더미 엑셀 생성:", out_path)
